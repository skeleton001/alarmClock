!function(){"use strict";function a(a,e,r,t,m){function i(){f.getTime(),f.alarm.time.toTimeString()<f.time.toTimeString()?f.alarm.isTomorrow=!0:f.alarm.isTomorrow=!1}function l(){return{0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}}function n(){f.someSelected=Object.keys(f.selection).some(function(a){return f.selection[a]}),f.someSelected||(f.alarm.isRepeat=!1,f.selection=reloadSelection())}function o(){f.alarm.repeatDays=[],f.alarm.isRepeat&&angular.forEach(f.selection,function(a,e){a&&f.alarm.repeatDays.push(e)})}function s(a,e){a=m("date")(a,"shortTime"),r.info("It's "+a,""+e)}function c(){f.time=new Date}function u(){e.set("alarms",f.alarms)}function g(){for(var a=0;a<f._alarmsObj.length;a++){if(f.alarm.time.setSeconds(0),f.alarm.time.toTimeString()==f._alarmsObj[a].time.toTimeString()){f.isExist=!0;break}f.isExist=!1}}function b(){e.clearAll(),f.alarms=[],f._alarmsObj=[]}function O(){f.sortDays(),f.isTomorrowCheck(),f.alarm.time.setSeconds(0),f.alarm.time=f.alarm.time.toGMTString(),f._alarm=angular.toJson(f.alarm),f.alarms.push(f._alarm),u(),f.alarm.time=new Date,t.go("alarm.list")}var f=this;f.hstep=1,f.mstep=1,f.ismeridian=!0,f.meridian="shortTime",f.time=new Date,f.days=[{name:"SUN",id:"0"},{name:"MON",id:"1"},{name:"TUE",id:"2"},{name:"WED",id:"3"},{name:"THU",id:"4"},{name:"FRI",id:"5"},{name:"SAT",id:"6"}],f.alarms=[],f._alarmsObj=[],e.get("alarms")&&(f.alarms=e.get("alarms")),f.alarm={},f.alarm.title="Alarm",f.alarm.time=new Date,f.alarm.isActive=!0,f.alarm.isRepeat=!1,f.alarm.isTomorrow=!1,f.alarm.repeatDays=[],f.isExist=!1,f.isTomorrowCheck=i,f.selection=l(),f.checkboxChanged=n,f.sortDays=o,f.setAlarm=O,f.changed=g,f.ring=s,f.getTime=c,f.deleteAllAlarm=b,a(function(){f.getTime(),angular.forEach(f.alarms,function(a,e){f.getTime(),f._alarmObj=JSON.parse(a),f._alarmObj.time=new Date(f._alarmObj.time),f._alarmObj.time.toTimeString()<=f.time.toTimeString()?(f._alarmObj.isActive&&!f._alarmObj.isTomorrow&&(f._alarmObj.isRepeat?angular.forEach(f._alarmObj.repeatDays,function(a){a==f.time.getDay()&&f.ring(f._alarmObj.time,f._alarmObj.title)}):(f.ring(f._alarmObj.time,f._alarmObj.title),f._alarmObj.isActive=!1)),f._alarmObj.isTomorrow=!0):f._alarmObj.isTomorrow=!1,f.alarms[e]=angular.toJson(f._alarmObj),f._alarmsObj[e]=f._alarmObj}),u()},990)}a.$inject=["$interval","localStorageService","toastr","$state","$filter"],angular.module("alarmClock").controller("AlarmController",a)}();